(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-3f163514"],{"37e8f":function(t,e,s){},"3f72":function(t,e,s){"use strict";var o=s("37e8f"),a=s.n(o);a.a},"782b":function(t,e,s){"use strict";s.r(e);var o=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"scoket-container"},[s("div",{staticClass:"chat-container"},[s("div",{staticClass:"status"},[t._v(" "+t._s(t.socketStatus)+" ")]),s("scroll-bar",{ref:"scrollBar",staticStyle:{width:"100%",height:"400px",padding:"6px 0 15px"}},[s("p",{staticClass:"text-center"},[t._v(t._s(t.newsList[t.newsList.length-1].date))]),t._l(t.newsList,(function(e,o){return s("div",{key:o,staticClass:"list-item",class:{"text-right":o%2===0}},[o%2==0?s("div",{staticClass:"message myself"},[t._v(t._s(e.message))]):t._e(),s("a-avatar",{attrs:{src:e.imgUrl,size:35}}),o%2!=0?s("div",{staticClass:"message",domProps:{innerHTML:t._s(e.message)}}):t._e()],1)}))],2)],1),s("a-comment",[s("a-avatar",{attrs:{slot:"avatar",src:t.imgUrl,alt:"Han Solo"},slot:"avatar"}),s("div",{attrs:{slot:"content"},slot:"content"},[s("a-form-item",[s("a-textarea",{attrs:{rows:3,value:t.textValue},on:{change:t.changeText}})],1),s("a-form-item",[s("a-button",{attrs:{"html-type":"submit",type:"primary"},on:{click:t.sendNews}},[t._v(" 发送 ")])],1)],1)],1)],1)},a=[],i=s("c1df"),n={data:function(){return{errorTimes:0,websock:null,imgUrl:s("c1ec"),socketStatus:"webSocket连接断开",newsList:[{user:"admin",imgUrl:s("c1ec"),message:"hello",date:"2020-12-27 15:36:24"},{user:"robot",imgUrl:s("ea42"),message:"hello",date:"2020-12-27 15:36:24"}],textValue:""}},created:function(){this.init()},destroyed:function(){this.websock.close()},methods:{init:function(){"undefined"!==typeof WebSocket?(this.websock=new WebSocket("ws://123.207.136.134:9010/ajaxchattest"),this.websock.onmessage=this.websocketonmessage,this.websock.onopen=this.websocketonopen,this.websock.onerror=this.websocketonerror,this.websock.onclose=this.websocketclose):alert("您的浏览器不支持socket")},websocketonopen:function(){this.errorTimes=0,this.socketStatus="webSocket已连接"},websocketonmessage:function(t){var e=this;this.socketStatus="输入中...",setTimeout((function(){e.newsList.push({user:"robot",imgUrl:s("ea42"),message:t.data,date:i().format("YYYY-MM-DD HH:mm:ss")}),e.socketStatus="webSocket已连接",e.$nextTick((function(){var t=e.$refs["scrollBar"].wrap;t.scrollTop=t.scrollHeight}))}),350)},websocketsend:function(t){this.websock.send(t),this.newsList.push({user:"admin",imgUrl:s("c1ec"),message:t,date:i().format("YYYY-MM-DD HH:mm:ss")}),this.textValue=""},websocketonerror:function(){if(2==this.errorTimes)return this.$message.error("连接失败,请稍后重试"),void(this.socketStatus="webSocket连接失败");this.errorTimes++,this.init()},websocketclose:function(t){this.socketStatus="webSocket连接断开"},changeText:function(t){this.textValue=t.target.value},sendNews:function(){this.textValue?this.websocketsend(this.textValue):this.$message.warning("输入内容不能为空")}}},c=n,r=(s("3f72"),s("2877")),l=Object(r["a"])(c,o,a,!1,null,"6813f3fa",null);e["default"]=l.exports},ea42:function(t,e,s){t.exports=s.p+"img/robot.674d11b6.png"}}]);