(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-41257b86"],{4281:function(e,t,n){},"64c5":function(e,t,n){"use strict";var a=n("4281"),r=n.n(a);r.a},"67d5":function(e,t,n){"use strict";n.d(t,"e",(function(){return r})),n.d(t,"b",(function(){return o})),n.d(t,"c",(function(){return i})),n.d(t,"a",(function(){return l})),n.d(t,"d",(function(){return s}));var a=n("b775");function r(e){return a["a"].post("/roleManage/roleTableData",e)}function o(e){return a["a"].post("/roleManage/deleteRole",e)}function i(e){return a["a"].post("/roleManage/editRole",e)}function l(e){return a["a"].post("/roleManage/addRole",e)}function s(e){return a["a"].post("/roleManage/getRole",e)}},a3cc:function(e,t,n){"use strict";var a=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("a-tree",{attrs:{checkable:"","tree-data":e.treeData},on:{check:e.handleSelect},model:{value:e.checkKeyList,callback:function(t){e.checkKeyList=t},expression:"checkKeyList"}})},r=[],o=(n("99af"),n("4de4"),n("4160"),n("ac1f"),n("1276"),n("159b"),n("2909")),i=n("a18c"),l={name:"standardTree",props:{role:String},data:function(){return{treeData:[],checkKeyList:[]}},computed:{asyncRoutes:function(){return i["a"]}},created:function(){var e=this.filtrRoute(this.asyncRoutes);this.treeData=this.generateRoutes(e),this.role?this.handleBatter(e):this.checkKeyList=[]},methods:{handleBatter:function(e){var t=this.getRouteId(e),n=this.role.split(","),a=[];t.forEach((function(e){n.forEach((function(t){e==t&&a.push(t)}))})),this.checkKeyList=a},getRouteId:function(e){var t=this,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,a=[];return e.forEach((function(e){e.children&&e.children.length>0?a.push.apply(a,Object(o["a"])(t.getRouteId(e.children,e.meta.role))):e.meta&&e.meta.role?a.push(String(e.meta.role)):n&&a.push(String(n))})),a},filtrRoute:function(e){return 0==e.length?[]:e.filter((function(e){return e.children}))[0].children},generateRoutes:function(e){var t=this,n=[];return e.forEach((function(e){if(e.meta&&e.meta.role){var a={key:String(e.meta.role),title:e.meta.title};e.children&&(a.children=t.generateRoutes(e.children)),n.push(a)}})),n},handleSelect:function(e,t){var n=[].concat(Object(o["a"])(e),Object(o["a"])(t.halfCheckedKeys));this.$emit("changeTree",n)}}},s=l,c=n("2877"),u=Object(c["a"])(s,a,r,!1,null,"3715bc64",null);t["a"]=u.exports},a567:function(e,t,n){"use strict";var a=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"tableCommon-wrapper"},[n("a-table",{attrs:{columns:e.tableHead,dataSource:e.tableData,loading:e.loading,pagination:e.pagination,"row-selection":e.rowSelection,rowKey:"id",scroll:e.scroll},on:{change:e.handleTableChange},scopedSlots:e._u([e._l(Object.keys(e.$scopedSlots).filter((function(e){return"expandedRowRender"!==e})),(function(t){return{key:t,fn:function(n,a,r){return[e._t(t,null,null,{text:n,record:a,index:r})]}}}))],null,!0)})],1)},r=[],o={name:"standardTable",props:{tableHead:{type:Array,required:!0},tableData:{type:Array,required:!0},loading:{type:Boolean,default:!1},pagination:{type:Boolean|Object},rowSelection:{type:Object},scroll:{type:Object}},data:function(){return{}},methods:{handleTableChange:function(e){this.$emit("changeCurrent",e.current)}}},i=o,l=n("2877"),s=Object(l["a"])(i,a,r,!1,null,"efa95cdc",null);t["a"]=s.exports},b4dd:function(e,t,n){"use strict";n("d3b7");var a=function(e){return new Promise((function(t,n){var a=document.getElementById(e);if(a)setTimeout((function(){t()}),500);else{var r=document.createElement("script");r.id=e,r.src=e,r.async=!0,document.body.appendChild(r),r.onload=function(){var e=this;setTimeout((function(){e.onerror=e.onload=null,t()}),500)},r.onerror=function(){this.onerror=this.onload=null,n("加载失败"+e)}}}))};t["a"]=a},c999:function(e,t,n){"use strict";n.r(t);var a=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"userManage-wrapper"},[n("a-card",{attrs:{hoverable:!0,bordered:!1}},[n("div",{staticClass:"flex flex-wrap",attrs:{slot:"title"},slot:"title"},[n("a-button",{staticClass:"select-bottom",attrs:{type:"primary",icon:"plus"},on:{click:e.handleAdd}},[e._v(" 新增用户 ")]),n("a-button",{staticStyle:{margin:"0 16px 10px"},attrs:{type:"danger",icon:"delete",loading:e.deleteLoading},on:{click:e.handleBatchDelete}},[e._v(" 批量删除 ")]),n("a-select",{staticClass:"select-width",attrs:{placeholder:"用户权限",allowClear:""},on:{change:e.changeRole}},e._l(e.roleOption,(function(t){return n("a-select-option",{key:t.role,attrs:{value:t.role}},[e._v(" "+e._s(t.roleString)+" ")])})),1),n("a-input",{staticClass:"select-width",attrs:{placeholder:"用户名",allowClear:""},on:{pressEnter:e.handleSearch},model:{value:e.tableQuery.username,callback:function(t){e.$set(e.tableQuery,"username",t)},expression:"tableQuery.username"}}),n("a-range-picker",{staticClass:"select-width",staticStyle:{width:"210px"},attrs:{placeholder:["开始日期","结束日期"],allowClear:""},on:{change:e.changeTime}}),n("a-button",{staticClass:"select-bottom",staticStyle:{"margin-right":"16px"},attrs:{type:"primary",icon:"search"},on:{click:e.handleSearch}},[e._v(" 查询 ")]),n("a-button",{staticClass:"select-bottom",attrs:{type:"primary",icon:"export",loading:e.exportLoading},on:{click:e.handleExport}},[e._v(" 导出 ")])],1),n("standard-table",{attrs:{tableData:e.tableData,tableHead:e.tableHead,loading:e.loading,pagination:!1,rowSelection:{selectedRowKeys:e.selectedRowKeys,onChange:e.handleSelect,getCheckboxProps:e.getCheckboxProps}},scopedSlots:e._u([{key:"index",fn:function(t){var a=t.index;return n("div",{},[e._v(" "+e._s(a+1)+" ")])}},{key:"role",fn:function(t){var a=t.text;return n("div",{},e._l(a.split(","),(function(t,a){return n("a-tag",{key:a,staticStyle:{"margin-bottom":"6px"},attrs:{color:e._f("statusFilter")(t)}},[e._v(" "+e._s(e._f("textFilter")(t,e.roleOption))+" ")])})),1)}},{key:"action",fn:function(t){var a=t.text;return n("div",{},[n("a-button",{attrs:{type:"primary",size:"small"},on:{click:function(t){return e.handleEdit(a)}}},[e._v(" 编辑 ")]),n("a-popconfirm",{attrs:{title:"你确定要删除当前列吗?","ok-text":"是","cancel-text":"否",disabled:a.role&&"admin"==a.role},on:{confirm:function(t){return e.handleDelete(a)}}},[n("a-button",{staticStyle:{"margin-left":"8px"},attrs:{type:"danger",size:"small",disabled:a.role&&"admin"==a.role}},[e._v(" 删除 ")])],1)],1)}}])})],1),e.dialogVisible?n("user-model",{attrs:{roleOption:e.roleOption,currentRow:e.currentRow,dialogVisible:e.dialogVisible},on:{cancel:function(t){e.dialogVisible=!1},ok:e.handleOk}}):e._e()],1)},r=[],o=(n("7db0"),n("4160"),n("a15b"),n("d81d"),n("b0c0"),n("d3b7"),n("159b"),n("5530")),i=(n("96cf"),n("1da1")),l=n("b775");function s(e){return l["a"].post("/userManage/userTable",e)}function c(e){return l["a"].post("/userManage/deleteTable",e)}function u(e){return l["a"].post("/userManage/batchDeleteTable",e)}function d(e){return l["a"].post("/userManage/editTable",e)}function p(e){return l["a"].post("/userManage/addTable",e)}var m=n("67d5"),h=n("ed08"),f=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("a-modal",{attrs:{title:e.currentRow?"编辑":"新增",visible:e.dialogVisible,okText:"确认",cancelText:"取消",width:620,confirmLoading:e.loading},on:{ok:e.handleSure,cancel:function(){e.$emit("cancel")}}},[n("a-form-model",{ref:"userFrom",attrs:{model:e.userFrom,rules:e.userRule,"label-col":{span:4},"wrapper-col":{span:16},hideRequiredMark:""}},[n("a-form-model-item",{directives:[{name:"show",rawName:"v-show",value:e.currentRow,expression:"currentRow"}],attrs:{prop:"id",label:"id"}},[n("a-input",{attrs:{disabled:""},model:{value:e.userFrom.id,callback:function(t){e.$set(e.userFrom,"id",t)},expression:"userFrom.id"}})],1),n("a-form-model-item",{attrs:{prop:"username",label:"用户名",hasFeedback:""}},[n("a-input",{model:{value:e.userFrom.username,callback:function(t){e.$set(e.userFrom,"username",t)},expression:"userFrom.username"}})],1),n("a-form-model-item",{attrs:{prop:"password",label:"密码",hasFeedback:""}},[n("a-input",{model:{value:e.userFrom.password,callback:function(t){e.$set(e.userFrom,"password",t)},expression:"userFrom.password"}})],1),n("a-form-model-item",{attrs:{prop:"role",label:"权限"}},[n("a-select",{attrs:{mode:"multiple",placeholder:"请选择角色",allowClear:"","default-value":e.userFrom.role?e.userFrom.role.split(","):void 0},on:{change:e.changeRole}},e._l(e.roleOption,(function(t){return n("a-select-option",{key:t.role},[e._v(" "+e._s(t.roleString)+" ")])})),1)],1),n("a-form-model-item",{attrs:{prop:"location",label:"所在城市",hasFeedback:""}},[n("a-input",{model:{value:e.userFrom.location,callback:function(t){e.$set(e.userFrom,"location",t)},expression:"userFrom.location"}})],1),n("a-form-model-item",{attrs:{prop:"position",label:"职位",hasFeedback:""}},[n("a-input",{model:{value:e.userFrom.position,callback:function(t){e.$set(e.userFrom,"position",t)},expression:"userFrom.position"}})],1),n("a-form-model-item",{attrs:{prop:"label",label:"个人介绍",hasFeedback:""}},[n("a-input",{model:{value:e.userFrom.label,callback:function(t){e.$set(e.userFrom,"label",t)},expression:"userFrom.label"}})],1),n("a-form-model-item",{attrs:{prop:"skill",label:"技能",hasFeedback:""}},[n("a-select",{attrs:{mode:"tags",placeholder:"请输入个人技能",maxTagCount:3,allowClear:"","default-value":e.userFrom.skill?e.userFrom.skill.split(","):void 0},on:{change:e.changeSkill}},e._l(e.SKILL_LIST,(function(t){return n("a-select-option",{key:t.label},[e._v(" "+e._s(t.label)+" ")])})),1)],1),n("a-form-model-item",{attrs:{prop:"text",label:"描述"}},[n("a-textarea",{attrs:{placeholder:"描述...",autoSize:{minRows:3,maxRows:5}},model:{value:e.userFrom.text,callback:function(t){e.$set(e.userFrom,"text",t)},expression:"userFrom.text"}})],1)],1)],1)},b=[],g=(n("ac1f"),n("5319"),n("a3cc")),v=n("5880"),x={name:"userModel",props:{currentRow:[Object,null],dialogVisible:Boolean,roleOption:Array},components:{standardTree:g["a"]},data:function(){return{userRule:{username:[{required:!0,trigger:"blur",message:"用户名不能为空！"}],password:[{required:!0,trigger:"blur",min:6,message:"密码不能少于6位！"}],role:[{required:!0,trigger:"blur",message:"请选择用户权限！"}],text:[{required:!0,trigger:"blur",min:5,message:"请至少输入五个字符描述！"}],location:[{required:!0,trigger:"blur",message:"请选择所在城市！"}],position:[{required:!0,trigger:"blur",message:"职位不能为空！"}],label:[{required:!0,trigger:"blur",message:"个人介绍不能为空！"}],skill:[{required:!0,trigger:"blur",message:"请至少勾选一项技能"}]},userFrom:{role:""},loading:!1}},computed:Object(v["mapGetters"])(["userInfo"]),mounted:function(){this.userFrom=Object(o["a"])({},this.currentRow)||{role:""}},methods:{changeSkill:function(e){this.userFrom.skill=e.join(",")},changeRole:function(e){this.userFrom.role=e.join(",")},handleSure:function(){var e=this;this.$refs.userFrom.validate((function(t){e.loading=!0,t?e.currentRow?d(e.userFrom).then(Object(i["a"])(regeneratorRuntime.mark((function t(){var n,a,r,o;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(n=e.userFrom,a=n.role,r=n.username,n.password,o=n.id,!a&&!r||o!=e.userInfo.id){t.next=9;break}return e.$message.success("修改成功,当前登录信息已发生变化，请重新登录"),t.next=5,e.$store.dispatch("user/logout");case 5:return t.next=7,e.$store.dispatch("tagsView/clearTag");case 7:return e.$router.replace({path:"/login"}),t.abrupt("return");case 9:e.$message.success("修改成功!"),e.loading=!1,e.$emit("ok");case 12:case"end":return t.stop()}}),t)})))):p(e.userFrom).then((function(){e.$message.success("添加成功!"),e.loading=!1,e.$emit("ok")})):e.loading=!1}))}}},w=x,k=n("2877"),y=Object(k["a"])(w,f,b,!1,null,null,null),R=y.exports,F=n("a567"),j=n("c1df"),S=n.n(j);n("5c3a");S.a.locale("zh-cn");var _=[{title:"序号",dataIndex:"index",scopedSlots:{customRender:"index"},width:60},{title:"id",dataIndex:"id",ellipsis:!0},{title:"用户名",dataIndex:"username"},{title:"密码",dataIndex:"password"},{title:"权限",dataIndex:"role",scopedSlots:{customRender:"role"}},{title:"创建日期",dataIndex:"date",defaultSortOrder:"ascend",sorter:function(e,t){return e.date>t.date},ellipsis:!0},{title:"描述",dataIndex:"text",ellipsis:!0},{title:"操作",scopedSlots:{customRender:"action"},width:140}],O={name:"userManage",components:{standardTable:F["a"],userModel:R},filters:{statusFilter:function(e){var t={admin:"#f50",test:"#2db7f5",editor:"#87d068",custom:""};return t[e]},textFilter:function(e,t){var n=t.find((function(t){return t.role==e}));return n?n.roleString:""}},data:function(){return{roleOption:[],tableQuery:{role:null,username:"",startTime:"",endTime:"",page:1,size:10},loading:!1,deleteLoading:!1,exportLoading:!1,tableData:[],selectedRowKeys:[],selectValue:[],dialogVisible:!1,currentRow:null,tableHead:_}},created:function(){this.getRoleOption()},mounted:function(){this.getTableList()},methods:{getRoleOption:function(){var e=this;return Object(i["a"])(regeneratorRuntime.mark((function t(){var n;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,Object(m["e"])();case 2:n=t.sent,e.roleOption=n.data||[];case 4:case"end":return t.stop()}}),t)})))()},changeRole:function(e){this.tableQuery.role=e},changeTime:function(e,t){Object.assign(this.tableQuery,{startTime:t[0],endTime:t[1]})},getCheckboxProps:function(e){return{props:{disabled:"admin"===e.role,name:e.name}}},handleSelect:function(e,t){this.selectedRowKeys=e,this.selectValue=t},handleSearch:function(){this.getTableList()},handleDelete:function(e){var t=this;c({id:e.id}).then((function(){t.$message.success("删除成功!"),t.getTableList()}))},handleBatchDelete:function(){var e=this;if(0!=this.selectValue.length){this.deleteLoading=!0;var t=this.selectValue.map((function(e){return e.id})).join(",");u({batchId:t}).then((function(){e.$message.success("删除成功!"),e.getTableList(),e.deleteLoading=!1}))}else this.$message.warning("请至少勾选一项")},handleEdit:function(e){this.currentRow=Object(o["a"])({},e),this.dialogVisible=!0},handleAdd:function(){this.currentRow=null,this.dialogVisible=!0},handleOk:function(){this.dialogVisible=!1,this.currentRow=null,this.getTableList()},handleExport:function(){var e=this;this.exportLoading=!0,Promise.all([n.e("chunk-6e87ca78"),n.e("chunk-b9614302"),n.e("chunk-2133cd4f")]).then(n.bind(null,"4bf8")).then((function(t){var n=[],a=[];e.tableHead.forEach((function(e){"操作"!=e.title&&"序号"!=e.title&&(n.push(e.title),a.push(e.dataIndex))}));var r=Object(h["b"])(e.tableData,a);t.export_json_to_excel({header:n,data:r,filename:"用户列表"}),e.exportLoading=!1}))},getTableList:function(){var e=this;this.loading=!0,s(this.tableQuery).then((function(t){var n=t.data||[];Object.assign(e,{tableData:n,loading:!1})}))}}},C=O,T=(n("64c5"),Object(k["a"])(C,a,r,!1,null,"116ac147",null));t["default"]=T.exports},ed08:function(e,t,n){"use strict";n.d(t,"a",(function(){return l})),n.d(t,"c",(function(){return s})),n.d(t,"b",(function(){return c}));n("4de4"),n("d81d"),n("d3b7"),n("ac1f"),n("25f0"),n("5319"),n("1276");var a=n("b4dd"),r=n("ef60"),o=r.AMapCDN,i=r.AMapUiCDN;function l(e,t){var n,a=arguments.length>2&&void 0!==arguments[2]&&arguments[2],r=this;return function(){for(var o=arguments.length,i=new Array(o),l=0;l<o;l++)i[l]=arguments[l];if(a)return e.apply(r,i),void(a=!1);clearTimeout(n),n=setTimeout((function(){e.apply(r,i)}),t)}}function s(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"";return new Promise((function(n,r){function l(e,t){AMapUI.loadUI(["geo/DistrictExplorer"],(function(a){var o=new a;o.loadAreaNode(e,(function(a,o){if(a)r(a);else{var i=o.getSubFeatures();if(0!==i.length){t&&(i=i.filter((function(e){return e.properties.adcode==t})));var s={features:i};n(s)}else{var c=o._data.geoData.parent.properties.acroutes;l(c[c.length-1],e)}}}))}))}window.AMap&&window.AMapUI?l(e,t):Object(a["a"])(o).then((function(){window.AMap&&Object(a["a"])(i).then((function(){window.AMapUI&&l(e,t)}))}))}))}function c(e,t){return e.map((function(e){return t.map((function(t){return e[t].toString()}))}))}},ef60:function(e,t){var n="https://webapi.amap.com/maps?v=1.3&key=73cddabc2173e0166a622f4483d3592a&plugin=AMap.DistrictSearch",a="https://webapi.amap.com/ui/1.0/main.js",r="https://cdn.jsdelivr.net/npm/vue@2.6.12/dist/vue.min.js",o="https://cdn.jsdelivr.net/npm/axios@0.21.0/dist/axios.min.js",i="https://cdn.jsdelivr.net/npm//vue-router@3.2.0/dist/vue-router.min.js",l="https://cdn.jsdelivr.net/npm/vuex@3.5.1/dist/vuex.min.js",s="https://cdn.jsdelivr.net/npm/tinymce-all-in-one@4.9.3/tinymce.min.js",c="https://cdn.jsdelivr.net/npm/html2canvas@1.0.0-rc.7/dist/html2canvas.min.js";e.exports={AMapCDN:n,AMapUiCDN:a,VueCDN:r,AxiosCDN:o,VueRouterCDN:i,VuexCDN:l,TinymceCDN:s,html2canvasCDN:c}}}]);